# (一)Git讲解

​	在早些年前的开发中,多个开发人员共同负责同一个[软件文档](https://www.baidu.com/s?wd=%E8%BD%AF%E4%BB%B6%E6%96%87%E6%A1%A3&tn=SE_PcZhidaonwhc_ngpagmjz&rsv_dl=gh_pc_zhidao)的开发，每个人在各自的机器上有整个[软件文档](https://www.baidu.com/s?wd=%E8%BD%AF%E4%BB%B6%E6%96%87%E6%A1%A3&tn=SE_PcZhidaonwhc_ngpagmjz&rsv_dl=gh_pc_zhidao)的备份，并对之实施编程开发，在分别完成各自任务之后，再通过文本比对工具将各自机器上的不同版本的程序整合到一台机器上，没有进行版本控制或者版本控制本身缺乏正确的流程管理，在软件开发过程中将会引入很多问题，如[软件代码](https://www.baidu.com/s?wd=%E8%BD%AF%E4%BB%B6%E4%BB%A3%E7%A0%81&tn=SE_PcZhidaonwhc_ngpagmjz&rsv_dl=gh_pc_zhidao)的一致性、软件内容的冗余、[软件过程](https://www.baidu.com/s?wd=%E8%BD%AF%E4%BB%B6%E8%BF%87%E7%A8%8B&tn=SE_PcZhidaonwhc_ngpagmjz&rsv_dl=gh_pc_zhidao)的事物性、软件开发过程中的并发性、软件源代码的安全性，以及软件的整合等问题。 

​	没有使用版本控制工具的开发工作，有人形容就如同生活在“黑暗时代”。版本控制工具是项目开发中必不可少的，以此进行的版本控制可以确保在软件项目开发中，不同的开发人员所涉及的同一文档都得到更新。

​	

## 一、版本控制工具的功能

​	在版本控制工具的历史上，出现过很多的软件，比如VSS 、CVS 、StarTeam 、SVN ，到如今最流行功能也强大Git。不管是哪个软件都会有相同到功能，下面我们来说说版本控制工具到功能。



- 协同开发
  - 多人并行修改服务器端的同一个文件
- 数据备份
  - 不仅可以保存文件和文件目录，还可以保存每次个提交过的历史记录
- 版本控制
  - 在保存每个版本的文件信息的时候要做到不保存重复数据，以节省存储空间，提高运行效率
  - 在这方面，SVN采用的是增量式的管理方式，Git采用的是文件系统快照
- 权限控制
  - 对团队内参与的开发人员进行权限控制
  - 对团队外参与的贡献者的代码进行审核--Git独有
- 历史记录
  - 查看修改人、修改时间、修改内容、日志信息
  - 将本地文件恢复到某一个历史状态
- 分支管理
  - 允许开发团队在工作过程中多条线路同时推进任务，进一步提高开发效率



## 二、版本控制工具的分类

​	对于市面上的版本控制大致分为两种类型：

​		1. 集中式版本控制工具

​		2. 分布式版本控制工具

​	那这两种有什么区别吗？下面进行简单的解说

### 2.1 集中式版本控制工具

- 常见的集中式版本控制系统：


​	CVS(最早、开源、免费)，SVN（开源、免费，目前用的最多），VSS(集成在Visual studio中)… 

- 工作流程： 


​	我们比较熟悉的SVN是集中式的版本控制系统，回想一下在使用svn时，每次干活之前，需要先从中央服务器（服务端）取出最新的版本，然后开始工作，干完活了，工作完后推送给中央服务器。此时的中央服务器就好比是一个图书馆，如果你要修改一本书，需要先从图书馆借出来，然后回到自己家修改，改完之后，需要在送回到图书馆。

- 分布简图：

  ![1537887795526](img\1537887795526.png)

- 工作特点：

  - 优点

    - 有一个单一的集中管理的服务器，保存所有文件的修订版本，所有代码库 
    - 对网络的依赖性强，必须联网才能工作，上传速度受网络状况、带宽影响 
    - 客户端记录文件内容的具体差异，每次记录有哪些文件做了更新，以及更新了哪些行的什么内容

  - 缺点 

    - 中央服务器的单点故障 

      如果中央服务器发生宕机，所有客户端将无法提交更新、还原、对比等，也就无法协同工作。如果磁盘发生故障，信息尚无备份，还会有数据丢失的风险。 

### 2.2 分布式版本控制工具

- 常见的分布式版本控制系统：

  git（免费、开源）、 Mercurial(轻量级)  、Monotone(免费)… 

- 工作流程：

  ​	分布式版本控制系统是没有“中央服务器”，每个人的电脑上都是一个完整的版本库，工作的时候，不再需要联网。开始工作前，在客户端克隆出完整的代码仓库，然后就可以在家、在公交车等等随心所欲地修改代码并提交了，提交到本地电脑，等到有网的时候就可以一次性地将本地仓库推送到远端仓库（临时中心服务器）中，这样一来，每个人都可以独立进行改动资料，并且所有的改动都是在完整资料信息的环境下进行的。

- 分布简图： 

  ![1537888657584](img\1537887547787.png)

- 工作特点：

  - 优点

    - 本地客户机进行操作，离线工作，快速 

    - 安全性高

       每个人电脑里都有完整的版本库，一个人的电脑换了复制其他人的一份就可以了 

    - 原子性提交，提交不会被打断（git） 

    - 工作模式非常灵活（传统的集中式工作流 + 特殊工作流 + 特殊工作流和集中式工作流的组合） 


### 2.3 版本控制工具类别总结

| 比较指标 |        比较项目         | 集中式 | 分布式 |
| :------: | :---------------------: | :----: | :----: |
|   性能   |     服务器扩展能力      |   ⭐    |  ⭐⭐⭐   |
|          |  本地保存完整历史版本   |   ×    |  ⭐⭐⭐   |
|   安全   |        数据安全         |   ⭐    |  ⭐⭐⭐   |
| 分支操作 |      代码合并能力       |   ⭐⭐   |  ⭐⭐⭐   |
|          |        分支管理         |   ⭐    |  ⭐⭐⭐   |
|          |      分支创建速度       |  ⭐⭐⭐   |   ⭐    |
| 权限控制 | 目录授权、分支授权等... |  ⭐⭐⭐   |   ×    |
|   其他   |        离线提交         |   ×    |  ⭐⭐⭐   |
|          |      远程版本复制       |  ⭐⭐⭐   |  ⭐⭐⭐   |

- ​	总结

  ​	分布式版本控制系统的出现解决了集中式需要联网操作的弊端，纵向来看，版本控制系统的变更根据使用者需求的变化而革新，横向来看，各有利弊，对应于svn和git来说，用过才会对他们的影响更加深刻。那么，现在企业中较为受欢迎的Git，我们后面会详细的讲解。

## 三、Git简史

​	我们从下面的图中大致可以看到Git的发展简史：
![1537894623903](img\1537894623903.png)

1. 1991年，在项目团队开发中，林纳斯需要手动合并代码实现项目的整合

2. 2002年，BitKeeper的东家BitMover公司出于人道主义精神，授权Linux社区免费使用这个版本控制系统，

   但要求不能进行破解

3. 2005年，Linux社区成员Samba试图破解BitKeeper版本控制系统，被BitMover公司发现并收回了系统的免费试用权

4. 2005年，处于开源社区对代码版本控制的热爱，林纳斯只用了两周时间，用C语言编写出Git的主程。一个月后Linux系统的代码控制就由Git来控制了

5. 2008年，使用Git技术提供代码托管平台GitHub上线，并提供了除Linux系统之外的Windows、MacOS的支持

## 四、Git的优势

### 4.1 Git的信息

​	Git是一个开源的分布式版本控制系统，可以有效，高速的处理从很小到非常大的项目版本管理。也被圈内称为目前世界上最先进的分布式版本控制系统！

​				![1538043428292](img\1538043428292.png)

​	从上面的Git图标上看，Git将自己最大的特点分支作为标志Logo。

> ​	Git官方网址：https://git-scm.com/

### 4.2 Git的优势

- 代码的控制大部分在本地完成，不需要进行联网

  - 本地在完成现有内容操作后，无需联网就可以提交的本地仓库，本地仓库就可以进行版本控制。

- 完整性保证

  - Git保存数据底层是使用hash算法进行存储的，这样的存储数据有几方面的好处
    - 同一个数据不管进行多少次hash运算，得到的hash值都是一样的
    - 不管一个数据有多大，得到的hash值的长度是固定的。

- 尽可能添加数据而不是删除数据或修改数据

  - 每次在进行提交时，不会对之前的数据进行修改或删除，而是产生新的版本存到仓库中。

    方便以后的数据回滚。

- 分支操作系统快捷流畅

  - Git的版本控制是采用快照方式进行存储数据的，而分支是不同快照数据的不同指针。我们创建分支或修改分支，都是对创建或移动指针。（此处后面会详细讲解）

- 与Linux命令全面兼容

  - Git和Linux都是有大神级人物林纳斯编写，其操作性是一致的，Linux和Git在命令上都是很强大的。

## 五、Git的安装

​	首先可以在Git官方网址上下载适合自己的Git版本，本次Git演示环境是Windows环境，下面都会以windows进行讲解，请读者知晓。



> ​	Git下载页面 ：https://git-scm.com/downloads



1. 首先在下载页面点击windows提供的链接地址

   ![1538048600276](img\1538048600276.png)

   

2. 在给出的下载软件中选择适合自己系统的版本进行下载

   ![1538048987466](img\1538048987466.png)

   > 上图中的的解释：
   >
   > ​	注释①：此为windows的安装版本。在安装版本中又分32位和64位
   >
   > ​		       根据不同windows系统下载与之对应的版本，
   >
   > ​        注释②：此为windows的便携版，也是我们俗称的绿色版或免安装版。
   >
   > ​                       
   >
   > ​	上面的两种版本可以根据自己的需求来进行下载。本次演示会采用安装版。

3. 对下载后的软件在系统中进行安装

   ![1538050919704](img\1538050919704.png)

4. 进入安装界面的首界面

   ![1538051106929](img\1538051106929.png)

5. 选择Git的安装路径，尽量安装到除C盘的其他盘符
   ![1538051295472](img\1538051295472.png)

   ![1538051364613](img\1538051364613.png)

6. 安装Git的组件，默认的选项即可

   ![1538051825793](img\1538051825793.png)

   > 安装组件解释
   >
   > ​	Additional icons -on the Desktop：将Git启动程序的图标安装到桌面上
   >
   > ​	Windows Expolorer integration ：将Git的命令窗口的快捷方式和
   >
   > ​								    Git的图形化界面的快捷方式
   >
   > ​								    添加到windows的右键菜单中
   >
   > ​	Git LFS：Git对大文本的支持
   >
   > ​	Associate  .git* configuration files with the default text editor：
   >
   > ​								    将Git程序关联文件名后缀为.git文件。
   >
   > ​	Associate .sh files to be run with Bash：
   >
   > ​						            将Git程雪关联文件名后缀为.sh文件，并把.sh文件中命令在Git中运行

7. 在windows的启动菜单中添加Git启动的快捷方式，默认即可

   ![1538052258397](img\1538052258397.png)

8. 选择Git中的编辑机器，默认是使用Linux中的Vim编辑器，用户可以根据自己的喜好进行选择，本次教程中使用默认的Vim编辑器

   ![1538052406254](img\1538052406254.png)

9. 在windows系统环境中调整Git环境变量，推荐选择第一个

   ![1538052685752](img\1538052685752.png)

   > 上图中的解释：
   >
   > ​	注释①：`Use Git from GIt Bash only`（推荐选择）
   >
   > ​			此设置不会对windows环境变量修改，对于系统来说是最安全的设置。但是Git命令
   > 		只能在Git Bash中使用，不过这完全够我们后面使用。
   >
   > ​	注释②：`Use Git from the Windows Command Prompt`
   >
   > ​			此设置会修改windows的环境变量，对于系统来说相对安全，但是有风险，不过可以在
   >
   > ​		windows的cmd中执行Git的基本命令。
   >
   > ​	注释③：`Use Git and optional Unix tools from the Windows Command Prompt`
   >
   > ​			此设置会修改windows的环境变量，会在环境变量中添加Unix的选项。在windows中命令
   >
   > ​		中使用Git命令。不过他会覆盖Windows的原有命令，比如：find，sort等等...这个选项是最不
   >
   > ​		安全的。

10. 选择客户端和远程库在链接上是采用哪种链接方式，默认选在第一种就可以

  ![1538054281170](img\1538054281170.png)

  > 上图解释：
  >
  > ​	注释①：`Use the OpenSSL library`
  >
  > ​				此选项使用OpenSSL方式来链接，较为通用，推荐采用。
  >
  > ​	注释②：`Use the native Windows Secure Channel library`
  >
  > ​				此选项使用windows的安全通道来链接，有一定的局限性，不推荐采用。

11. 选择Git对换行符的转换规则，默认选项即可

    ![1538054936921](img\1538054936921.png)

    > 说明：此选项中是Git对内容中的换行符的转换，对我们的使用没有说明影响。所以对此不过多介绍，选在默认即可。

12. 选择Git的终端，默认选择Min TTY即可

    ![1538055609913](img\1538055609913.png)

    > 上图解释：
    >
    > ​	注释①：Use MinTTY
    >
    > ​				此选项是Git的默认终端，推荐使用。
    >
    > ​		        关于Min TTY的介绍：https://baike.baidu.com/item/MinTTY/9579126?fr=aladdin
    >
    > ​	注释②： Use Windows default console window
    >
    > ​				此选项会采用windows中的cmd作为Git的终端，不推荐。

13. 设置Git的其他选项，默认选项即可

    ![1538056106315](img\1538056106315.png)

14. 设置Git可选项，默认即可

    ![1538056979246](img\1538056979246.png)

    > 上图解释：
    >
    > ​	注释①：Enable file system caching
    >
    > ​			开启文件缓存系统，这样提交Git的性能，默认会选择上。
    >
    > ​	注释②：Enable Git Credential Manager 
    >
    > ​			开启Git对windows的证书管理器，默认选择上。
    >
    > ​	注释③：Enable symbolic links
    >
    > ​			开启Git的仓库软连接（快捷方式），可选。

    

15. 开启Git是实验性选项，默认不勾选

    ![1538057482361](img\1538057482361.png)

    > 说明：对于Git的实验性选项，只能在lightly tested中使用，大家可以选择性进行选择。前面的基本设置
    >
    > ​	   就都大家使用，所以本次对此不进行设置。

16. 开始安装Git

    ![1538057919388](img\1538057919388.png)

    ![1538057974010](img\1538057974010.png)

17. 安装完毕后，我们可以通过右键菜单中看到Git的快捷方式，一般会通过此入口进入Git命令

    ![1538058371151](img\1538058132352.png)

18. 下面的窗口就是我们后期一直要使用的Git Bash命令窗口

    ![1538058556786](img\1538058556786.png)

    > 说明：对于Git GUI Here
    >
    > ​	   是Git对创建本地仓库的界面版
    >
    > ​        	![1538111156883](img\1538111156883.png)
    >
    > ​	  这个可以帮助我们完成Git仓库的克隆和创建，但对于复杂的操作还是需要使用Git Bash，在这里我们就不对它进行讲解了。



## 六、Git存储结构和基础操作

​	在Git中，我们将需要进行版本控制的文件目录叫做一个**仓库（repository）**，每个仓库可以简单理解成一个目录，这个目录里面的所有文件都通过Git来实现版本管理，Git都能跟踪并记录在该目录中发生的所有更新。

​        现在我们已经知道什么是repository（缩写repo）了，假如我们现在建立一个仓库（repo），那么在建立仓库的这个目录中有一个“.git”的隐藏文件夹。这个文件夹非常重要，所有的版本信息，更新记录，以及Git进行仓库管理的相关信息全部保存在这个文件夹里面。所以，不要修改/删除其中的文件，以免造成数据的丢失。 

![1538120510913](img\1538120510913.png)

> 说明：此test目录就是一个git仓库目录。在此目录中的资源都会被git所管理。如果出了这个目录，git仓
> 	    库将不会做管理。

### 6.1Git结构讲解

​	在Git学习过程中，遇到了如下三大个概念：**工作区**、**暂存区**和**版本库**。刚开始觉得Git不就是一个版本控制系统嘛，搞这么多概念干嘛。实际上正是这些概念，让Git的版本控制更加便捷和高效。

- **工作区**：在初始化git版本库之后会生成一个隐藏的目录 `.git` ，可以将该目录理解为git的版本库 repository，而我们自己建立的项目文件夹即工作区 working directory。  

  

  ![1538126188450](img\1538126188450.png)

  > 说明：图中的Demo是创建出的工程项目，而此目录可以看成是一个工作区

- **暂存区**：暂存区可以理解为一个虚拟工作区，这个虚拟工作区会跟踪工作区的文件变化（增删改等操作）。这个虚拟工作区位于`.git`目录下的index文件中存储。

  ![1538127240939](img\1538127240939.png)

  > 上图解释
  >
  > ​	注释①：在 ./test/.git目录中的暂存区（虚拟工作区）index文件记录着
  >
  > ​		       工作区  `(注释②)` 的所有文件的变化。
  >
  > ​	注释②：在 ./test目录中的工作区的文件都会被git管理，一旦有文件内容
  >
  > ​		        产生变化，都会被暂存区index（虚拟工作区）跟踪。

- **版本库**：在初始化git版本库之后会生成一个隐藏的文件 `.git` ，可以将该文件理解为git的版本库 repository 

  ![1538120510913](img\1538120510913.png)



​	下面通过一张图理解为工作区、暂存区和版本库的关系： 
	![1538112129368](img\1538112129368.png)

> 上图解释：
>
> - Git的操作围绕工作区、暂存区（图中的`index`）、版本库（图中的`master`，实际上这是版本库的主分支）、对象库（图中的`objects`）几个部分进行
> - 工作区、暂存区和版本库都维持着一棵目录树
> - 暂存区跟踪记录了工作区的文件名和文件状态（修改时间，文件大小等信息）
> - 执行git add会更新暂存区的目录树，同时将工作区的文件内容生成一个对象放入`objects`对象库中，在暂存区记录了该对象的索引`index`
> - 执行git commit会更新版本库的目录树，commit成功后版本库指向的目录树就是暂存区的目录树
> - `objects` 标识的区域为 Git 的对象库，实际位于`.git/objects`目录下
> - 图中的HEAD是一个指向最新commit的引用，可以通过版本回退的方式改变HEAD的指向

​	在图中还有其他的命令，这里可以暂时不用理会，后面就会慢慢理解的。目前只需要理解    `git add`
和`git commit`这两个命令就可以。 

### 6.2 Git基本操作

​	日常中，我们对于git的使用命令有很多。如果要是熟练使用的话，最少需要掌握50-100多个命令才可以，听上去真是让人汗颜。不过对于日常的基础操作，简单的几个命令就可以来使用Git。

​	那么，接下来我们通过图例来演示Git的基本命令操作。

#### 6.2.1 Git的三大区：工作区、暂存区、版本库基本命令操作

​	首先我们来演示Git的三大区域中的基本命令操作，下图为例：

![1538139349933](img\1538137790439.png)

> ​	上图解释：
>
> - ​	工作区基本操作
>
> 			1. 工作区可以通过   `add`命令将工作区文件添加到暂存区中，让暂存区对工作区中的文件开始追踪
>
> 			2. 如果想将添加到暂存区中的数据撤销，也就是让暂存区放弃对工作区或工作区中的某个文件追踪
>
> 			     这时候我们可以使用  `rm`命令
>    
> 			    暂存区的基本操作	
>
>   		 1. 如果工作区的文件已经添加到暂存区中，这时候执行  `commit`命令可以将暂存区中的数据提交到	
>
>   		     版本中
>
>   		 2. 如果工作区的文件已经添加到暂存区中，这时候执行   `checkout`命令，会用暂存区全部或指定的
>
>   		     文件替换工作区的文件。这个操作很危险，会清除工作区中未添加到暂存区的改动 

#### 6.2.2 Git的本地版本库基本操作

​	下面通过图例来演示本地版本的基本操作：

![1538140053794](img\1538140053794.png)

> ​	上图解释：
>
> ​		1. 如果本地版本库中已经有数据，这个时候执行   `push`命令就可以将本地版本库中的内容上传到远
>
> ​		    程Git操作中
>
> ​                2.如果想将远程仓库中的数据下载到本地，并作为本地版本库使用，我们可以使用命令
>
> ​                   `clone/fetch`来进行操作   